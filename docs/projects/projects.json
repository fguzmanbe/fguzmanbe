[
  {
    "path": "projects/2023-11-15-maddison-project-database-2020/",
    "title": "Maddison Project Database 2020",
    "description": "We will work with the data provided by the Maddison Project and create a graph showing the GDP per capita growth of selected countries.",
    "author": [
      {
        "name": "Francisco Guzmán",
        "url": {}
      }
    ],
    "date": "2023-11-15",
    "categories": [
      "ggplot2",
      "plotly"
    ],
    "contents": "\r\n\r\nContents\r\nLibraries\r\nDatabase\r\nImport\r\nunique()\r\nsummary()\r\nfilter()\r\n\r\nGraph\r\nggplot()\r\nplotly()\r\n\r\nCode\r\nReferences\r\n\r\nLibraries\r\n\r\n\r\nlibrary(readxl)\r\nlibrary(ggplot2)\r\nlibrary(plotly)\r\nlibrary(Cairo)\r\nlibrary(scales)\r\nlibrary(ggthemes)\r\nlibrary(dplyr)\r\n\r\n\r\nDatabase\r\nImport\r\nWe obtain the data from the Maddison Project Database 2020. Then, we import it.\r\n\r\n\r\nmpd2020 <- as.data.frame(read_excel(\"mpd2020.xlsx\", sheet = \"Full data\"))\r\n\r\n\r\nunique()\r\nThe following command might be useful for country selection. In this case, we’ll compare Chile’s growth with Norway, Sweden, Finland, New Zealand, and Australia.\r\n\r\n\r\nunique(mpd2020[c(\"countrycode\", \"country\")])\r\n\r\n\r\nsummary()\r\nWith the following command, we are interested in seeing the period that will be covered in the graph, considering the available data for Chile.\r\n\r\n\r\nmpd2020 %>% \r\n  filter(countrycode == \"CHL\") %>%\r\n  summary()\r\n\r\n countrycode          country               year          gdppc      \r\n Length:210         Length:210         Min.   :1800   Min.   :  781  \r\n Class :character   Class :character   1st Qu.:1861   1st Qu.: 1578  \r\n Mode  :character   Mode  :character   Median :1914   Median : 3878  \r\n                                       Mean   :1913   Mean   : 5548  \r\n                                       3rd Qu.:1966   3rd Qu.: 7292  \r\n                                       Max.   :2018   Max.   :22105  \r\n                                                                     \r\n      pop       \r\n Min.   :  771  \r\n 1st Qu.: 1930  \r\n Median : 3678  \r\n Mean   : 5925  \r\n 3rd Qu.: 9114  \r\n Max.   :18676  \r\n NA's   :11     \r\n\r\nWe see that there is data for Chile from 1800, so the graph will start from that year.\r\nfilter()\r\nGiven the information from the previous two steps, we filter the database to leave it with what we need. We can create a new one in case we need the complete database for something else.\r\n\r\n\r\ndf_graf1 <- mpd2020 %>%\r\n  filter(countrycode %in% c(\"CHL\", \"NOR\", \"SWE\", \"FIN\", \"NZL\", \"AUS\"),\r\n         year>=1800)\r\n\r\n\r\nGraph\r\nggplot()\r\n\r\n\r\nmy_palette = c(\"#DA0000\", \"#239f40\", \"#C4961A\", \"#CC79A7\", \"#C3D7A4\", \"#293352\")\r\n\r\ng1 <- ggplot(data = df_graf1, aes(year, gdppc, color=country)) +\r\n  geom_line(size = 1) +\r\n  labs(title = \"International Comparison of Real GDP per capita in 2011$\",\r\n       subtitle = \"1800-2018\",\r\n       caption = \"Source: Personal elaboration with Maddison Project Database 2020\",\r\n       x = \"\",\r\n       y = \"\",\r\n       col = NULL) +\r\n  scale_color_manual(values = my_palette) +\r\n  scale_x_continuous(breaks=seq(1800,2020, by = 10), position = \"bottom\") +\r\n  scale_y_continuous(labels = dollar) +\r\n  theme_tufte() +\r\n  theme(plot.title = element_text(size = rel(1.4)),\r\n        plot.subtitle = element_text(size = rel(1.2), margin=margin(0,0,20,0)),\r\n        plot.caption = element_text(hjust = 0, face= \"italic\"),\r\n        axis.text.x = element_text(angle = 90, vjust=.5, size = 10),\r\n        axis.text.y = element_text(angle = 0, vjust=0, size = 10),\r\n        axis.ticks.length.x = unit(.25, \"cm\"),\r\n        axis.ticks.x = element_line(size = .5),\r\n        axis.ticks.y = element_blank(),\r\n        panel.grid.major.y = element_line(colour = \"grey90\"),\r\n        panel.grid.minor.y = element_line(colour = \"grey90\"))\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nplotly()\r\nWith this command, we get an interactive plot.\r\n\r\n\r\nfig <- ggplotly(g1)\r\nfig\r\n\r\n\r\n\r\nCode\r\n\r\n\r\nShow code\r\n\r\nlibrary(readxl)\r\nlibrary(ggplot2)\r\nlibrary(plotly)\r\nlibrary(Cairo)\r\nlibrary(scales)\r\nlibrary(ggthemes)\r\nlibrary(dplyr)\r\n\r\nmpd2020 <- as.data.frame(read_excel(\"mpd2020.xlsx\", sheet = \"Full data\"))\r\n\r\nunique(mpd2020[c(\"countrycode\", \"country\")])\r\n\r\nmpd2020 %>% \r\n  filter(countrycode == \"CHL\") %>%\r\n  summary()\r\ndf_graf1 <- mpd2020 %>%\r\n  filter(countrycode %in% c(\"CHL\", \"NOR\", \"SWE\", \"FIN\", \"NZL\", \"AUS\"),\r\n         year>=1800)\r\n\r\nmy_palette = c(\"#DA0000\", \"#239f40\", \"#C4961A\", \"#CC79A7\", \"#C3D7A4\", \"#293352\")\r\n\r\ng1 <- ggplot(data = df_graf1, aes(year, gdppc, color=country)) +\r\n  geom_line(size = 1) +\r\n  labs(title = \"International Comparison of Real GDP per capita in 2011$\",\r\n       subtitle = \"1800-2018\",\r\n       caption = \"Source: Personal elaboration with Maddison Project Database 2020\",\r\n       x = \"\",\r\n       y = \"\",\r\n       col = NULL) +\r\n  scale_color_manual(values = my_palette) +\r\n  scale_x_continuous(breaks=seq(1800,2020, by = 10), position = \"bottom\") +\r\n  scale_y_continuous(labels = dollar) +\r\n  theme_tufte() +\r\n  theme(plot.title = element_text(size = rel(1.4)),\r\n        plot.subtitle = element_text(size = rel(1.2), margin=margin(0,0,20,0)),\r\n        plot.caption = element_text(hjust = 0, face= \"italic\"),\r\n        axis.text.x = element_text(angle = 90, vjust=.5, size = 10),\r\n        axis.text.y = element_text(angle = 0, vjust=0, size = 10),\r\n        axis.ticks.length.x = unit(.25, \"cm\"),\r\n        axis.ticks.x = element_line(size = .5),\r\n        axis.ticks.y = element_blank(),\r\n        panel.grid.major.y = element_line(colour = \"grey90\"),\r\n        panel.grid.minor.y = element_line(colour = \"grey90\"))\r\n\r\n# To save in png format\r\nggsave(g1, filename = \"plot.png\", type = 'cairo', dpi = 300,\r\n       width = 18, height = 13.5, units = \"cm\")\r\n\r\n# For higher quality (pdf or eps)\r\nggsave(g1, filename = \"plot.pdf\", device = cairo_pdf, dpi = 300,\r\n       width = 18, height = 13.5, units = \"cm\")\r\n\r\nggsave(g1, filename = \"plot.eps\", device = cairo_ps, dpi = 300,\r\n       width = 18, height = 13.5, units = \"cm\")\r\nknitr::include_graphics(\"plot.png\")\r\n\r\nfig <- ggplotly(g1)\r\nfig\r\n\r\n\r\nReferences\r\nggplot2\r\nggplotly\r\nMaddison Project Database 2020\r\n\r\n\r\n\r\n",
    "preview": "projects/2023-11-15-maddison-project-database-2020/distill-preview.png",
    "last_modified": "2023-11-15T13:25:03+00:00",
    "input_file": {}
  },
  {
    "path": "projects/2023-11-12-ingreso-promedio-per-cpita/",
    "title": "Average Per Capita Income",
    "description": "We will work with the Lakner-Milanovic (2013) dataset to create some graphics on average per capita income (PPP 2005) during the period 1988-2008.",
    "author": [
      {
        "name": "Francisco Guzmán",
        "url": {}
      }
    ],
    "date": "2023-11-12",
    "categories": [
      "Lakner-Milanovic (2013)",
      "Shiny App"
    ],
    "contents": "\r\n\r\nContents\r\nLibraries\r\nDatabase\r\nAcquisition\r\nImport\r\nVisualization\r\n\r\nGraph\r\nSave\r\n\r\nMore Graphics\r\nChile vs Portugal\r\nChile vs Sweden\r\nChile vs Netherlands\r\nChile vs Spain and Bolivia\r\n\r\nInteractive Plot\r\nCode\r\nReferences\r\n\r\nLibraries\r\nNote that by loading tidyverse, other packages are loaded as well. You can review them here.\r\n\r\n\r\nlibrary(haven)\r\nlibrary(tidyverse)\r\nlibrary(scales)\r\nlibrary(ggthemes)\r\nlibrary(gganimate)\r\nlibrary(plotly)\r\nlibrary(ggiraph)\r\nlibrary(Cairo)\r\n\r\n\r\nDatabase\r\nAcquisition\r\nGo to Lakner-Milanovic (2013) World Panel Income Distribution (LM-WPID) and download the file in STATA (.dta) format.\r\nImport\r\nSince the format is .dta, we use the read_dta command provided by the haven library.\r\n\r\n\r\ndf <- read_dta(\"lm_wpid_web.dta\")\r\nattach(df)\r\n\r\n\r\nVisualization\r\nSee the variables we will use in constructing our graph. For more information on these and the dataset in general, check the pdf.\r\n\r\n\r\nhead(df)[c(1,8,9,11)]\r\n\r\n# A tibble: 6 × 4\r\n  contcod bin_year group RRinc\r\n  <chr>      <dbl> <dbl> <dbl>\r\n1 AGO         1993     1   174\r\n2 AGO         1993     2   287\r\n3 AGO         1993     3   373\r\n4 AGO         1993     4   450\r\n5 AGO         1993     5   538\r\n6 AGO         1993     6   653\r\n\r\nGraph\r\nThe filter() command allows us to select the countries we want to graph.\r\nThe pipe operator %>% allows us to perform multiple operations.\r\nThe girafe() command allows us to add a tooltip, making our graph more interactive. geom_point_interactive() should be added first.\r\n\r\n\r\ng1 <- df %>%\r\n  \r\n  filter(contcod %in% c(\"CHL\", \"ESP\")) %>% \r\n  \r\n  ggplot(aes(x = group, y = RRinc, color = contcod)) +\r\n  geom_point_interactive(aes(tooltip = RRinc)) +\r\n                           geom_line() +\r\n  labs(title = \"Average per Capita Income by Decile (PPP 2005)\",\r\n       subtitle = \"Chile vs Spain, 1988-2008\",\r\n       caption = \"Source: Own elaboration based on Lakner-Milanovic (2013)\",\r\n       x = \"Deciles\",\r\n       y = \"USD - PPP 2005\",\r\n       col = NULL) +\r\n       scale_color_manual(values = c(\"#DA0000\", \"#C4961A\")) +\r\n       scale_x_continuous(breaks=seq(1,10, by = 1), position = \"bottom\") +\r\n       scale_y_continuous(labels = dollar) +\r\n       facet_wrap(~bin_year, ncol = 3) +\r\n  theme(plot.title = element_text(size = rel(2)),\r\n        plot.subtitle = element_text(size = rel(1.4),\r\n                                     margin=margin(0,0,20,0)),\r\n        plot.caption = element_text(size = rel(.9),\r\n                                    hjust = 0,\r\n                                    face= \"italic\",\r\n                                    margin=margin(20,0,0,0)),\r\n        axis.text.x = element_text(angle = 0, vjust=.5, size = 10),\r\n        axis.text.y = element_text(angle = 0, vjust=.5, size = 10),\r\n        axis.ticks.length.x = unit(.2, \"cm\"),\r\n        axis.ticks.x = element_line(size = .3),\r\n        axis.ticks.length.y = unit(.2, \"cm\"),\r\n        axis.ticks.y = element_line(size = .3),\r\n        panel.grid.major.x = element_line(colour = \"grey87\"),\r\n        panel.grid.minor.x = element_line(colour = \"grey92\"),\r\n        panel.grid.major.y = element_line(colour = \"grey87\"),\r\n        panel.grid.minor.y = element_line(colour = \"grey87\"),\r\n        legend.position = c(0.87, 0.22),\r\n        legend.text = element_text(size = 13),\r\n        legend.key.size = unit(3,\"line\"))\r\n\r\ngirafe(ggobj = g1, width_svg = 8, height_svg = 6)\r\n\r\n\r\n\r\nSave\r\n\r\n\r\n# To save in png format\r\nggsave(g1, filename = \"plot.png\", type = 'cairo', dpi = 300,\r\n       width = 8, height = 6)\r\n\r\n# To save with higher quality (pdf or eps)\r\nggsave(g1, filename = \"plot.pdf\", device = cairo_pdf, dpi = 300,\r\n       width = 8, height = 6)\r\n\r\nggsave(g1, filename = \"plot.eps\", device = cairo_ps, dpi = 300,\r\n       width = 8, height = 6)\r\n\r\n\r\nMore Graphics\r\nChile vs Portugal\r\n\r\n\r\nShow code\r\n\r\ng2 <- df %>%\r\n  \r\n  filter(contcod %in% c(\"CHL\", \"PRT\")) %>% \r\n  \r\n  ggplot(aes(x = group, y = RRinc, color = contcod)) +\r\n  geom_point_interactive(aes(tooltip = RRinc)) +\r\n                           geom_line() +\r\n  labs(title = \"Average per Capita Income by Decile (PPP 2005)\",\r\n       subtitle = \"Chile vs Portugal, 1988-2008\",\r\n       caption = \"Source: Own elaboration based on Lakner-Milanovic (2013)\",\r\n       x = \"Deciles\",\r\n       y = \"USD - PPP 2005\",\r\n       col = NULL) +\r\n       scale_color_manual(values = c(\"#DA0000\", \"#239f40\")) +\r\n       scale_x_continuous(breaks=seq(1,10, by = 1), position = \"bottom\") +\r\n       scale_y_continuous(labels = dollar, limits = c(0, 30000)) +\r\n       facet_wrap(~bin_year, ncol = 3) +\r\n  theme(plot.title = element_text(size = rel(2)),\r\n        plot.subtitle = element_text(size = rel(1.4),\r\n                                     margin=margin(0,0,20,0)),\r\n        plot.caption = element_text(size = rel(.9),\r\n                                    hjust = 0,\r\n                                    face= \"italic\",\r\n                                    margin=margin(20,0,0,0)),\r\n        axis.text.x = element_text(angle = 0, vjust=.5, size = 10),\r\n        axis.text.y = element_text(angle = 0, vjust=.5, size = 10),\r\n        axis.ticks.length.x = unit(.2, \"cm\"),\r\n        axis.ticks.x = element_line(size = .3),\r\n        axis.ticks.length.y = unit(.2, \"cm\"),\r\n        axis.ticks.y = element_line(size = .3),\r\n        panel.grid.major.x = element_line(colour = \"grey87\"),\r\n        panel.grid.minor.x = element_line(colour = \"grey92\"),\r\n        panel.grid.major.y = element_line(colour = \"grey87\"),\r\n        panel.grid.minor.y = element_line(colour = \"grey87\"),\r\n        legend.position = c(0.87, 0.22),\r\n        legend.text = element_text(size = 13),\r\n        legend.key.size = unit(3,\"line\"))\r\n\r\ngirafe(ggobj = g2, width_svg = 8, height_svg = 6)\r\n\r\n\r\n\r\nChile vs Sweden\r\nNo data for Sweden in 1988.\r\n\r\n\r\nShow code\r\n\r\ng3 <- df %>%\r\n  \r\n  filter(contcod %in% c(\"CHL\", \"SWE\")) %>% \r\n  \r\n  ggplot(aes(x = group, y = RRinc, color = contcod)) +\r\n  geom_point_interactive(aes(tooltip = RRinc)) +\r\n                           geom_line() +\r\n  labs(title = \"Average per Capita Income by Decile (PPP 2005)\",\r\n       subtitle = \"Chile vs Sweden, 1988-2008\",\r\n       caption = \"Source: Own elaboration based on Lakner-Milanovic (2013)\",\r\n       x = \"Deciles\",\r\n       y = \"USD - PPP 2005\",\r\n       col = NULL) +\r\n       scale_color_manual(values = c(\"#DA0000\", \"#293352\")) +\r\n       scale_x_continuous(breaks=seq(1,10, by = 1), position = \"bottom\") +\r\n       scale_y_continuous(labels = dollar) +\r\n       facet_wrap(~bin_year, ncol = 3) +\r\n  theme(plot.title = element_text(size = rel(2)),\r\n        plot.subtitle = element_text(size = rel(1.4),\r\n                                     margin=margin(0,0,20,0)),\r\n        plot.caption = element_text(size = rel(.9),\r\n                                    hjust = 0,\r\n                                    face= \"italic\",\r\n                                    margin=margin(20,0,0,0)),\r\n        axis.text.x = element_text(angle = 0, vjust=.5, size = 10),\r\n        axis.text.y = element_text(angle = 0, vjust=.5, size = 10),\r\n        axis.ticks.length.x = unit(.2, \"cm\"),\r\n        axis.ticks.x = element_line(size = .3),\r\n        axis.ticks.length.y = unit(.2, \"cm\"),\r\n        axis.ticks.y = element_line(size = .3),\r\n        panel.grid.major.x = element_line(colour = \"grey87\"),\r\n        panel.grid.minor.x = element_line(colour = \"grey92\"),\r\n        panel.grid.major.y = element_line(colour = \"grey87\"),\r\n        panel.grid.minor.y = element_line(colour = \"grey87\"),\r\n        legend.position = c(0.87, 0.22),\r\n        legend.text = element_text(size = 13),\r\n        legend.key.size = unit(3,\"line\"))\r\n\r\ngirafe(ggobj = g3, width_svg = 8, height_svg = 6)\r\n\r\n\r\n\r\nChile vs Netherlands\r\n\r\n\r\nShow code\r\n\r\ng4 <- df %>%\r\n  \r\n  filter(contcod %in% c(\"CHL\", \"NLD\")) %>% \r\n  \r\n  ggplot(aes(x = group, y = RRinc, color = contcod)) +\r\n  geom_point_interactive(aes(tooltip = RRinc)) +\r\n                           geom_line() +\r\n  labs(title = \"Average per Capita Income by Decile (PPP 2005)\",\r\n       subtitle = \"Chile vs Netherlands, 1988-2008\",\r\n       caption = \"Source: Own elaboration based on Lakner-Milanovic (2013)\",\r\n       x = \"Deciles\",\r\n       y = \"USD - PPP 2005\",\r\n       col = NULL) +\r\n       scale_color_manual(values = c(\"#DA0000\", \"#f37735\")) +\r\n       scale_x_continuous(breaks=seq(1,10, by = 1), position = \"bottom\") +\r\n       scale_y_continuous(labels = dollar, limits = c(0, 40000)) +\r\n       facet_wrap(~bin_year, ncol = 3) +\r\n  theme(plot.title = element_text(size = rel(2)),\r\n        plot.subtitle = element_text(size = rel(1.4),\r\n                                     margin=margin(0,0,20,0)),\r\n        plot.caption = element_text(size = rel(.9),\r\n                                    hjust = 0,\r\n                                    face= \"italic\",\r\n                                    margin=margin(20,0,0,0)),\r\n        axis.text.x = element_text(angle = 0, vjust=.5, size = 10),\r\n        axis.text.y = element_text(angle = 0, vjust=.5, size = 10),\r\n        axis.ticks.length.x = unit(.2, \"cm\"),\r\n        axis.ticks.x = element_line(size = .3),\r\n        axis.ticks.length.y = unit(.2, \"cm\"),\r\n        axis.ticks.y = element_line(size = .3),\r\n        panel.grid.major.x = element_line(colour = \"grey87\"),\r\n        panel.grid.minor.x = element_line(colour = \"grey92\"),\r\n        panel.grid.major.y = element_line(colour = \"grey87\"),\r\n        panel.grid.minor.y = element_line(colour = \"grey87\"),\r\n        legend.position = c(0.87, 0.22),\r\n        legend.text = element_text(size = 13),\r\n        legend.key.size = unit(3,\"line\"))\r\n\r\ngirafe(ggobj = g4, width_svg = 8, height_svg = 6)\r\n\r\n\r\n\r\nChile vs Spain and Bolivia\r\n\r\n\r\nShow code\r\n\r\ng5 <- df %>%\r\n  \r\n  filter(contcod %in% c(\"CHL\", \"ESP\", \"BOL\")) %>% \r\n  \r\n  ggplot(aes(x = group, y = RRinc, color = contcod)) +\r\n  geom_point_interactive(aes(tooltip = RRinc)) +\r\n                           geom_line() +\r\n   labs(title = \"Average per Capita Income by Decile (PPP 2005)\",\r\n       subtitle = \"Chile vs Spain and Bolivia, 1988-2008\",\r\n       caption = \"Source: Own elaboration based on Lakner-Milanovic (2013)\",\r\n       x = \"Deciles\",\r\n       y = \"USD - PPP 2005\",\r\n       col = NULL) +\r\n       scale_color_manual(values = c(\"#239f40\", \"#DA0000\", \"#C4961A\")) +\r\n       scale_x_continuous(breaks=seq(1,10, by = 1), position = \"bottom\") +\r\n       scale_y_continuous(labels = dollar, limits = c(0, 30000)) +\r\n       facet_wrap(~bin_year, ncol = 3) +\r\n  theme(plot.title = element_text(size = rel(2)),\r\n        plot.subtitle = element_text(size = rel(1.4),\r\n                                     margin=margin(0,0,20,0)),\r\n        plot.caption = element_text(size = rel(.9),\r\n                                    hjust = 0,\r\n                                    face= \"italic\",\r\n                                    margin=margin(20,0,0,0)),\r\n        axis.text.x = element_text(angle = 0, vjust=.5, size = 10),\r\n        axis.text.y = element_text(angle = 0, vjust=.5, size = 10),\r\n        axis.ticks.length.x = unit(.2, \"cm\"),\r\n        axis.ticks.x = element_line(size = .3),\r\n        axis.ticks.length.y = unit(.2, \"cm\"),\r\n        axis.ticks.y = element_line(size = .3),\r\n        panel.grid.major.x = element_line(colour = \"grey87\"),\r\n        panel.grid.minor.x = element_line(colour = \"grey92\"),\r\n        panel.grid.major.y = element_line(colour = \"grey87\"),\r\n        panel.grid.minor.y = element_line(colour = \"grey87\"),\r\n        legend.position = c(0.87, 0.22),\r\n        legend.text = element_text(size = 13),\r\n        legend.key.size = unit(3,\"line\"))\r\n\r\ngirafe(ggobj = g5, width_svg = 8, height_svg = 6)\r\n\r\n\r\n\r\nInteractive Plot\r\nTo access the following link, click on the Shiny App.\r\n\r\n\r\n\r\nCode\r\n\r\n\r\nShow code\r\n\r\nlibrary(haven)\r\nlibrary(tidyverse)\r\nlibrary(scales)\r\nlibrary(ggthemes)\r\nlibrary(gganimate)\r\nlibrary(plotly)\r\nlibrary(ggiraph)\r\nlibrary(Cairo)\r\n\r\ndf <- read_dta(\"lm_wpid_web.dta\")\r\nattach(df)\r\n\r\nhead(df)[c(1,8,9,11)]\r\n\r\ng1 <- df %>%\r\n  \r\n  filter(contcod %in% c(\"CHL\", \"ESP\")) %>% \r\n  \r\n  ggplot(aes(x = group, y = RRinc, color = contcod)) +\r\n  geom_point_interactive(aes(tooltip = RRinc)) +\r\n                           geom_line() +\r\n  labs(title = \"Average per Capita Income by Decile (PPP 2005)\",\r\n       subtitle = \"Chile vs Spain, 1988-2008\",\r\n       caption = \"Source: Own elaboration based on Lakner-Milanovic (2013)\",\r\n       x = \"Deciles\",\r\n       y = \"USD - PPP 2005\",\r\n       col = NULL) +\r\n       scale_color_manual(values = c(\"#DA0000\", \"#C4961A\")) +\r\n       scale_x_continuous(breaks=seq(1,10, by = 1), position = \"bottom\") +\r\n       scale_y_continuous(labels = dollar) +\r\n       facet_wrap(~bin_year, ncol = 3) +\r\n  theme(plot.title = element_text(size = rel(2)),\r\n        plot.subtitle = element_text(size = rel(1.4),\r\n                                     margin=margin(0,0,20,0)),\r\n        plot.caption = element_text(size = rel(.9),\r\n                                    hjust = 0,\r\n                                    face= \"italic\",\r\n                                    margin=margin(20,0,0,0)),\r\n        axis.text.x = element_text(angle = 0, vjust=.5, size = 10),\r\n        axis.text.y = element_text(angle = 0, vjust=.5, size = 10),\r\n        axis.ticks.length.x = unit(.2, \"cm\"),\r\n        axis.ticks.x = element_line(size = .3),\r\n        axis.ticks.length.y = unit(.2, \"cm\"),\r\n        axis.ticks.y = element_line(size = .3),\r\n        panel.grid.major.x = element_line(colour = \"grey87\"),\r\n        panel.grid.minor.x = element_line(colour = \"grey92\"),\r\n        panel.grid.major.y = element_line(colour = \"grey87\"),\r\n        panel.grid.minor.y = element_line(colour = \"grey87\"),\r\n        legend.position = c(0.87, 0.22),\r\n        legend.text = element_text(size = 13),\r\n        legend.key.size = unit(3,\"line\"))\r\n\r\ngirafe(ggobj = g1, width_svg = 8, height_svg = 6)\r\n\r\n# To save in png format\r\nggsave(g1, filename = \"plot.png\", type = 'cairo', dpi = 300,\r\n       width = 8, height = 6)\r\n\r\n# To save with higher quality (pdf or eps)\r\nggsave(g1, filename = \"plot.pdf\", device = cairo_pdf, dpi = 300,\r\n       width = 8, height = 6)\r\n\r\nggsave(g1, filename = \"plot.eps\", device = cairo_ps, dpi = 300,\r\n       width = 8, height = 6)\r\ng2 <- df %>%\r\n  \r\n  filter(contcod %in% c(\"CHL\", \"PRT\")) %>% \r\n  \r\n  ggplot(aes(x = group, y = RRinc, color = contcod)) +\r\n  geom_point_interactive(aes(tooltip = RRinc)) +\r\n                           geom_line() +\r\n  labs(title = \"Average per Capita Income by Decile (PPP 2005)\",\r\n       subtitle = \"Chile vs Portugal, 1988-2008\",\r\n       caption = \"Source: Own elaboration based on Lakner-Milanovic (2013)\",\r\n       x = \"Deciles\",\r\n       y = \"USD - PPP 2005\",\r\n       col = NULL) +\r\n       scale_color_manual(values = c(\"#DA0000\", \"#239f40\")) +\r\n       scale_x_continuous(breaks=seq(1,10, by = 1), position = \"bottom\") +\r\n       scale_y_continuous(labels = dollar, limits = c(0, 30000)) +\r\n       facet_wrap(~bin_year, ncol = 3) +\r\n  theme(plot.title = element_text(size = rel(2)),\r\n        plot.subtitle = element_text(size = rel(1.4),\r\n                                     margin=margin(0,0,20,0)),\r\n        plot.caption = element_text(size = rel(.9),\r\n                                    hjust = 0,\r\n                                    face= \"italic\",\r\n                                    margin=margin(20,0,0,0)),\r\n        axis.text.x = element_text(angle = 0, vjust=.5, size = 10),\r\n        axis.text.y = element_text(angle = 0, vjust=.5, size = 10),\r\n        axis.ticks.length.x = unit(.2, \"cm\"),\r\n        axis.ticks.x = element_line(size = .3),\r\n        axis.ticks.length.y = unit(.2, \"cm\"),\r\n        axis.ticks.y = element_line(size = .3),\r\n        panel.grid.major.x = element_line(colour = \"grey87\"),\r\n        panel.grid.minor.x = element_line(colour = \"grey92\"),\r\n        panel.grid.major.y = element_line(colour = \"grey87\"),\r\n        panel.grid.minor.y = element_line(colour = \"grey87\"),\r\n        legend.position = c(0.87, 0.22),\r\n        legend.text = element_text(size = 13),\r\n        legend.key.size = unit(3,\"line\"))\r\n\r\ngirafe(ggobj = g2, width_svg = 8, height_svg = 6)\r\n\r\ng3 <- df %>%\r\n  \r\n  filter(contcod %in% c(\"CHL\", \"SWE\")) %>% \r\n  \r\n  ggplot(aes(x = group, y = RRinc, color = contcod)) +\r\n  geom_point_interactive(aes(tooltip = RRinc)) +\r\n                           geom_line() +\r\n  labs(title = \"Average per Capita Income by Decile (PPP 2005)\",\r\n       subtitle = \"Chile vs Sweden, 1988-2008\",\r\n       caption = \"Source: Own elaboration based on Lakner-Milanovic (2013)\",\r\n       x = \"Deciles\",\r\n       y = \"USD - PPP 2005\",\r\n       col = NULL) +\r\n       scale_color_manual(values = c(\"#DA0000\", \"#293352\")) +\r\n       scale_x_continuous(breaks=seq(1,10, by = 1), position = \"bottom\") +\r\n       scale_y_continuous(labels = dollar) +\r\n       facet_wrap(~bin_year, ncol = 3) +\r\n  theme(plot.title = element_text(size = rel(2)),\r\n        plot.subtitle = element_text(size = rel(1.4),\r\n                                     margin=margin(0,0,20,0)),\r\n        plot.caption = element_text(size = rel(.9),\r\n                                    hjust = 0,\r\n                                    face= \"italic\",\r\n                                    margin=margin(20,0,0,0)),\r\n        axis.text.x = element_text(angle = 0, vjust=.5, size = 10),\r\n        axis.text.y = element_text(angle = 0, vjust=.5, size = 10),\r\n        axis.ticks.length.x = unit(.2, \"cm\"),\r\n        axis.ticks.x = element_line(size = .3),\r\n        axis.ticks.length.y = unit(.2, \"cm\"),\r\n        axis.ticks.y = element_line(size = .3),\r\n        panel.grid.major.x = element_line(colour = \"grey87\"),\r\n        panel.grid.minor.x = element_line(colour = \"grey92\"),\r\n        panel.grid.major.y = element_line(colour = \"grey87\"),\r\n        panel.grid.minor.y = element_line(colour = \"grey87\"),\r\n        legend.position = c(0.87, 0.22),\r\n        legend.text = element_text(size = 13),\r\n        legend.key.size = unit(3,\"line\"))\r\n\r\ngirafe(ggobj = g3, width_svg = 8, height_svg = 6)\r\n\r\ng4 <- df %>%\r\n  \r\n  filter(contcod %in% c(\"CHL\", \"NLD\")) %>% \r\n  \r\n  ggplot(aes(x = group, y = RRinc, color = contcod)) +\r\n  geom_point_interactive(aes(tooltip = RRinc)) +\r\n                           geom_line() +\r\n  labs(title = \"Average per Capita Income by Decile (PPP 2005)\",\r\n       subtitle = \"Chile vs Netherlands, 1988-2008\",\r\n       caption = \"Source: Own elaboration based on Lakner-Milanovic (2013)\",\r\n       x = \"Deciles\",\r\n       y = \"USD - PPP 2005\",\r\n       col = NULL) +\r\n       scale_color_manual(values = c(\"#DA0000\", \"#f37735\")) +\r\n       scale_x_continuous(breaks=seq(1,10, by = 1), position = \"bottom\") +\r\n       scale_y_continuous(labels = dollar, limits = c(0, 40000)) +\r\n       facet_wrap(~bin_year, ncol = 3) +\r\n  theme(plot.title = element_text(size = rel(2)),\r\n        plot.subtitle = element_text(size = rel(1.4),\r\n                                     margin=margin(0,0,20,0)),\r\n        plot.caption = element_text(size = rel(.9),\r\n                                    hjust = 0,\r\n                                    face= \"italic\",\r\n                                    margin=margin(20,0,0,0)),\r\n        axis.text.x = element_text(angle = 0, vjust=.5, size = 10),\r\n        axis.text.y = element_text(angle = 0, vjust=.5, size = 10),\r\n        axis.ticks.length.x = unit(.2, \"cm\"),\r\n        axis.ticks.x = element_line(size = .3),\r\n        axis.ticks.length.y = unit(.2, \"cm\"),\r\n        axis.ticks.y = element_line(size = .3),\r\n        panel.grid.major.x = element_line(colour = \"grey87\"),\r\n        panel.grid.minor.x = element_line(colour = \"grey92\"),\r\n        panel.grid.major.y = element_line(colour = \"grey87\"),\r\n        panel.grid.minor.y = element_line(colour = \"grey87\"),\r\n        legend.position = c(0.87, 0.22),\r\n        legend.text = element_text(size = 13),\r\n        legend.key.size = unit(3,\"line\"))\r\n\r\ngirafe(ggobj = g4, width_svg = 8, height_svg = 6)\r\n\r\ng5 <- df %>%\r\n  \r\n  filter(contcod %in% c(\"CHL\", \"ESP\", \"BOL\")) %>% \r\n  \r\n  ggplot(aes(x = group, y = RRinc, color = contcod)) +\r\n  geom_point_interactive(aes(tooltip = RRinc)) +\r\n                           geom_line() +\r\n   labs(title = \"Average per Capita Income by Decile (PPP 2005)\",\r\n       subtitle = \"Chile vs Spain and Bolivia, 1988-2008\",\r\n       caption = \"Source: Own elaboration based on Lakner-Milanovic (2013)\",\r\n       x = \"Deciles\",\r\n       y = \"USD - PPP 2005\",\r\n       col = NULL) +\r\n       scale_color_manual(values = c(\"#239f40\", \"#DA0000\", \"#C4961A\")) +\r\n       scale_x_continuous(breaks=seq(1,10, by = 1), position = \"bottom\") +\r\n       scale_y_continuous(labels = dollar, limits = c(0, 30000)) +\r\n       facet_wrap(~bin_year, ncol = 3) +\r\n  theme(plot.title = element_text(size = rel(2)),\r\n        plot.subtitle = element_text(size = rel(1.4),\r\n                                     margin=margin(0,0,20,0)),\r\n        plot.caption = element_text(size = rel(.9),\r\n                                    hjust = 0,\r\n                                    face= \"italic\",\r\n                                    margin=margin(20,0,0,0)),\r\n        axis.text.x = element_text(angle = 0, vjust=.5, size = 10),\r\n        axis.text.y = element_text(angle = 0, vjust=.5, size = 10),\r\n        axis.ticks.length.x = unit(.2, \"cm\"),\r\n        axis.ticks.x = element_line(size = .3),\r\n        axis.ticks.length.y = unit(.2, \"cm\"),\r\n        axis.ticks.y = element_line(size = .3),\r\n        panel.grid.major.x = element_line(colour = \"grey87\"),\r\n        panel.grid.minor.x = element_line(colour = \"grey92\"),\r\n        panel.grid.major.y = element_line(colour = \"grey87\"),\r\n        panel.grid.minor.y = element_line(colour = \"grey87\"),\r\n        legend.position = c(0.87, 0.22),\r\n        legend.text = element_text(size = 13),\r\n        legend.key.size = unit(3,\"line\"))\r\n\r\ngirafe(ggobj = g5, width_svg = 8, height_svg = 6)\r\n\r\nknitr::include_graphics(\"captura.png\")\r\n\r\n\r\nReferences\r\nLakner-Milanovic (2013) World Panel Income Distribution (LM-WPID)\r\nOperador pipe\r\ntidyverse\r\n\r\n\r\n\r\n",
    "preview": "projects/2023-11-12-ingreso-promedio-per-cpita/plot.png",
    "last_modified": "2023-11-15T12:32:32+00:00",
    "input_file": {}
  },
  {
    "path": "projects/2023-11-15-paquete-wdi/",
    "title": "World Development Indicators (WDI) package",
    "description": "Comparison of real GDP per capita (PPP) between countries. Data source: World Bank (using WDI package).",
    "author": [
      {
        "name": "Francisco Guzmán",
        "url": {}
      }
    ],
    "date": "2021-11-15",
    "categories": [
      "WDI",
      "ggplot2"
    ],
    "contents": "\r\n\r\nContents\r\nLibraries\r\nDatabase\r\nSearch\r\nDownload\r\nModifications\r\nunique()/filter()\r\nrename()\r\nmutate()/recode()\r\n\r\nAnalysis\r\n\r\nGraph\r\nCode\r\nReferences\r\n\r\nLibraries\r\n\r\n\r\nlibrary(WDI)\r\nlibrary(dplyr)\r\nlibrary(ggplot2)\r\nlibrary(ggthemes)\r\nlibrary(Cairo)\r\nlibrary(scales)\r\n\r\n\r\nDatabase\r\nSearch\r\nThe WDIsearch() command is used to search for databases using keywords. In this case, we’re interested in comparing the real GDP per capita of Chile, measured in PPP, so our keywords will be gdp, ppp and constant. This translates to the following:\r\n\r\n\r\nWDIsearch('gdp.*ppp.*constant')\r\n\r\n                 indicator\r\n717     6.0.GDPpc_constant\r\n11423    NY.GDP.MKTP.PP.KD\r\n11424 NY.GDP.MKTP.PP.KD.87\r\n11435    NY.GDP.PCAP.PP.KD\r\n11436 NY.GDP.PCAP.PP.KD.87\r\n                                                      name\r\n717   GDP per capita, PPP (constant 2011 international $) \r\n11423             GDP, PPP (constant 2017 international $)\r\n11424             GDP, PPP (constant 1987 international $)\r\n11435  GDP per capita, PPP (constant 2017 international $)\r\n11436  GDP per capita, PPP (constant 1987 international $)\r\n\r\nFrom the 5 options displayed in the result, for the purpose of this article, we’ll go with number 4: “GDP per capita, PPP (constant 2017 international $)”.\r\nDownload\r\nWith the following command, we can get the database and apply previous filters.\r\n\r\n\r\ndf <- WDI(\r\n  country = \"all\",\r\n  indicator = \"NY.GDP.PCAP.PP.KD\",\r\n  start = 1990,\r\n  end = 2020,\r\n  extra = FALSE,\r\n  cache = NULL,\r\n  latest = NULL,\r\n  language = \"es\"\r\n)\r\n\r\n\r\nModifications\r\nunique()/filter()\r\nUsing unique(), we view the country codes for selection, then apply filter().\r\n\r\n\r\nunique(df[c(\"iso2c\", \"country\")])\r\n\r\n\r\n\r\n\r\ndf <- filter(df, iso2c %in% c(\"ZJ\", \"AU\", \"CL\", \"NZ\", \"NO\", \"US\"))\r\n\r\n\r\nrename()\r\nWith rename(), we can modify variable names.\r\n\r\n\r\ndf <- rename(df, gdp_pc = NY.GDP.PCAP.PP.KD)\r\n\r\n\r\nmutate()/recode()\r\nThese commands allow us to change category names.\r\n\r\n\r\ndf <- df %>% mutate(country = recode(country,\r\n                            \"AmÃ©rica Latina y el Caribe\" = \"América Latina y el Caribe\"))\r\n\r\n\r\nAnalysis\r\nWe analyze the ranking of countries according to GDP per capita for the year 2019.\r\n\r\n\r\ndf %>% \r\n  filter(year == 2019) %>%\r\n  select(country, gdp_pc) %>%\r\n  arrange(-gdp_pc) %>% \r\n  head(6)\r\n\r\n                     country   gdp_pc\r\n1                    Noruega 64983.35\r\n2             Estados Unidos 62470.93\r\n3                  Australia 49379.09\r\n4             Nueva Zelandia 43272.57\r\n5                      Chile 24809.86\r\n6 América Latina y el Caribe 16075.42\r\n\r\nWe compare the GDP per capita of Chile with New Zealand in 1990 and 2015.\r\n\r\n\r\ndf %>% \r\n  filter(year %in% c(1990,2015) & iso2c %in% c(\"CL\",\"NZ\")) %>%\r\n  select(country, year, gdp_pc)\r\n\r\n         country year    gdp_pc\r\n1          Chile 2015 24464.746\r\n2          Chile 1990  9701.824\r\n3 Nueva Zelandia 2015 41014.687\r\n4 Nueva Zelandia 1990 27998.398\r\n\r\nGraph\r\n\r\n\r\nmy_palette = c(\"#DA0000\", \"#239f40\", \"#C4961A\", \"#CC79A7\", \"#C3D7A4\", \"#293352\")\r\n\r\ng1 <- ggplot(df, aes(year, gdp_pc, color=country)) +\r\n  geom_line(size = 1) +\r\n  labs(title = \"GDP per capita, PPP ($ constant 2017 international prices)\",\r\n       subtitle = \"Period 1990-2019\",\r\n       caption = \"Source: Self-elaboration based on World Bank data\",\r\n       col = NULL) +\r\n  scale_color_manual(values = my_palette) +\r\n  scale_x_continuous(breaks=seq(1990,2020, by = 5)) +\r\n  scale_y_continuous(labels = dollar) +\r\n  theme_fivethirtyeight() +\r\n  theme(plot.title = element_text(size = rel(1.05)),\r\n        plot.subtitle = element_text(size = rel(.9), margin=margin(0,0,20,0)),\r\n        plot.caption = element_text(hjust = 0, face= \"italic\"),\r\n        axis.text.x = element_text(angle = 0, vjust=1, size = 8),\r\n        axis.text.y = element_text(angle = 0, vjust=0, size = 8),\r\n        legend.position = \"bottom\",\r\n        panel.grid.major = element_line(colour = \"white\"))\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nCode\r\n\r\n\r\nShow code\r\n\r\nlibrary(WDI)\r\nlibrary(dplyr)\r\nlibrary(ggplot2)\r\nlibrary(ggthemes)\r\nlibrary(Cairo)\r\nlibrary(scales)\r\n\r\nWDIsearch('gdp.*ppp.*constant')\r\n\r\ndf <- WDI(\r\n  country = \"all\",\r\n  indicator = \"NY.GDP.PCAP.PP.KD\",\r\n  start = 1990,\r\n  end = 2020,\r\n  extra = FALSE,\r\n  cache = NULL,\r\n  latest = NULL,\r\n  language = \"es\"\r\n)\r\n\r\nunique(df[c(\"iso2c\", \"country\")])\r\ndf <- filter(df, iso2c %in% c(\"ZJ\", \"AU\", \"CL\", \"NZ\", \"NO\", \"US\"))\r\n\r\ndf <- rename(df, gdp_pc = NY.GDP.PCAP.PP.KD)\r\n\r\ndf <- df %>% mutate(country = recode(country,\r\n                            \"AmÃ©rica Latina y el Caribe\" = \"América Latina y el Caribe\"))\r\ndf %>% \r\n  filter(year == 2019) %>%\r\n  select(country, gdp_pc) %>%\r\n  arrange(-gdp_pc) %>% \r\n  head(6)\r\n\r\ndf %>% \r\n  filter(year %in% c(1990,2015) & iso2c %in% c(\"CL\",\"NZ\")) %>%\r\n  select(country, year, gdp_pc)\r\n\r\nmy_palette = c(\"#DA0000\", \"#239f40\", \"#C4961A\", \"#CC79A7\", \"#C3D7A4\", \"#293352\")\r\n\r\ng1 <- ggplot(df, aes(year, gdp_pc, color=country)) +\r\n  geom_line(size = 1) +\r\n  labs(title = \"GDP per capita, PPP ($ constant 2017 international prices)\",\r\n       subtitle = \"Period 1990-2019\",\r\n       caption = \"Source: Self-elaboration based on World Bank data\",\r\n       col = NULL) +\r\n  scale_color_manual(values = my_palette) +\r\n  scale_x_continuous(breaks=seq(1990,2020, by = 5)) +\r\n  scale_y_continuous(labels = dollar) +\r\n  theme_fivethirtyeight() +\r\n  theme(plot.title = element_text(size = rel(1.05)),\r\n        plot.subtitle = element_text(size = rel(.9), margin=margin(0,0,20,0)),\r\n        plot.caption = element_text(hjust = 0, face= \"italic\"),\r\n        axis.text.x = element_text(angle = 0, vjust=1, size = 8),\r\n        axis.text.y = element_text(angle = 0, vjust=0, size = 8),\r\n        legend.position = \"bottom\",\r\n        panel.grid.major = element_line(colour = \"white\"))\r\n\r\n# Save in png format\r\nggsave(g1, filename = \"plot.png\", type = 'cairo', dpi = 300,\r\n width = 18, height = 13.5, units = \"cm\")\r\n\r\n# Save in higher quality (pdf or eps)\r\nggsave(g1, filename = \"plot.pdf\", device = cairo_pdf, dpi = 300,\r\n width = 18, height = 13.5, units = \"cm\")\r\n\r\nggsave(g1, filename = \"plot.eps\", device = cairo_ps, dpi = 300,\r\n width = 18, height = 13.5, units = \"cm\")\r\nknitr::include_graphics(\"plot.png\")\r\n\r\n\r\nReferences\r\nggplot2\r\nWDI\r\n\r\n\r\n\r\n",
    "preview": "projects/2023-11-15-paquete-wdi/plot.png",
    "last_modified": "2023-11-15T13:53:26+00:00",
    "input_file": {}
  }
]
